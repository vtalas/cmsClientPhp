function ngcLazyImage(){var n="loader16.gif";return{scope:{ngcLazyImage:"="},link:function(t,i,r){r.loader!==undefined&&(n=r.loader);i.attr("src",n);t.$watch("ngcLazyImage",function(n){n!==undefined&&i.attr("src",n)})}}}function simpleDragDirective(){var n=function(n,t,i,r){var u,f;n.pageX&&n.pageY&&(u=n.pageX-i,f=n.pageY-r,t.css("left",u),t.css("top",f))};return{link:function(t,i){var r=0,u=0;i.bind({dragstart:function(t){var f=t.originalEvent;r=f.offsetX;u=f.offsetY;n(f,i,r,u);i.css("position","absolute")},dragover:function(t){var e=t.originalEvent,f;t.stopPropagation();t.preventDefault();f=t.originalEvent.dataTransfer;f.effectAllowed=f.dropEffect="none";n(e,i,r,u)},dragenter:function(n){n.stopPropagation();n.preventDefault();var t=n.originalEvent.dataTransfer;t.effectAllowed=t.dropEffect="none"}})}}}var ApiWrapper,ngcGdataAlbumDirective,ngcResponsiveImage,module;angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.position","ui.bootstrap.tooltip"]);angular.module("ui.bootstrap.tpls",["template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html"]);angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(n,t){function i(n,i){return n.currentStyle?n.currentStyle[i]:t.getComputedStyle?t.getComputedStyle(n)[i]:n.style[i]}function r(n){return"static"===(i(n,"position")||"static")}var u=function(t){for(var u=n[0],i=t.offsetParent||u;i&&i!==u&&r(i);)i=i.offsetParent;return i||u};return{position:function(t){var f=this.offset(t),i={top:0,left:0},r=u(t[0]);return r!=n[0]&&(i=this.offset(angular.element(r)),i.top+=r.clientTop,i.left+=r.clientLeft),{width:t.prop("offsetWidth"),height:t.prop("offsetHeight"),top:f.top-i.top,left:f.left-i.left}},offset:function(i){var r=i[0].getBoundingClientRect();return{width:i.prop("offsetWidth"),height:i.prop("offsetHeight"),top:r.top+(t.pageYOffset||n[0].body.scrollTop),left:r.left+(t.pageXOffset||n[0].body.scrollLeft)}}}}]);angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position"]).provider("$tooltip",function(){function i(n){var t="-";return n.replace(/[A-Z]/g,function(n,i){return(i?t:"")+n.toLowerCase()})}var r={placement:"top",animation:!0,popupDelay:0},n={mouseenter:"mouseleave",click:"click",focus:"blur"},t={};this.options=function(n){angular.extend(t,n)};this.$get=["$window","$compile","$timeout","$parse","$document","$position",function(u,f,e,o,s,h){return function(u,c,l){function y(t){var i,r;return i=t||v.trigger||l,r=angular.isDefined(v.trigger)?n[v.trigger]||i:n[i]||i,{show:i,hide:r}}var v=angular.extend({},r,t),p=i(u),a=y(void 0),w="<"+p+'-popup title="{{tt_title}}" content="{{tt_content}}" placement="{{tt_placement}}" animation="tt_animation()" is-open="tt_isOpen"><\/'+p+"-popup>";return{restrict:"EA",scope:!0,link:function(n,t,i){function nt(){n.tt_isOpen?k():b()}function b(){n.tt_popupDelay?g=e(d,n.tt_popupDelay):n.$apply(d)}function k(){n.$apply(function(){tt()})}function d(){var i,f,o,u;if(n.tt_content){switch(l&&e.cancel(l),r.css({top:0,left:0,display:"block"}),v.appendToBody?(p=p||s.find("body"),p.append(r)):t.after(r),i=h.position(t),f=r.prop("offsetWidth"),o=r.prop("offsetHeight"),n.tt_placement){case"right":u={top:i.top+i.height/2-o/2+"px",left:i.left+i.width+"px"};break;case"bottom":u={top:i.top+i.height+"px",left:i.left+i.width/2-f/2+"px"};break;case"left":u={top:i.top+i.height/2-o/2+"px",left:i.left-f+"px"};break;default:u={top:i.top-o+"px",left:i.left+i.width/2-f/2+"px"}}r.css(u);n.tt_isOpen=!0}}function tt(){n.tt_isOpen=!1;e.cancel(g);angular.isDefined(n.tt_animation)&&n.tt_animation()?l=e(function(){r.remove()},500):r.remove()}var l,g,p,r=f(w)(n);n.tt_isOpen=!1;i.$observe(u,function(t){n.tt_content=t});i.$observe(c+"Title",function(t){n.tt_title=t});i.$observe(c+"Placement",function(t){n.tt_placement=angular.isDefined(t)?t:v.placement});i.$observe(c+"Animation",function(t){n.tt_animation=angular.isDefined(t)?o(t):function(){return v.animation}});i.$observe(c+"PopupDelay",function(t){var i=parseInt(t,10);n.tt_popupDelay=isNaN(i)?v.popupDelay:i});i.$observe(c+"Trigger",function(n){t.unbind(a.show);t.unbind(a.hide);a=y(n);a.show===a.hide?t.bind(a.show,nt):(t.bind(a.show,b),t.bind(a.hide,k))})}}}}]}).directive("tooltipPopup",function(){return{restrict:"E",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(n){return n("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"E",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(n){return n("tooltipHtmlUnsafe","tooltip","mouseenter")}]);angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(n){n.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"><\/div>\n  <div class="tooltip-inner" ng-bind-html-unsafe="content"><\/div>\n<\/div>\n')}]);angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(n){n.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"><\/div>\n  <div class="tooltip-inner" ng-bind="content"><\/div>\n<\/div>\n')}]);ApiWrapper=function(){function n(n,t){this.cmsApi=n;this.cache=t}return n.prototype.chuj=function(n,t,i){var r=this.cache.get(n);return r?(t.resolve(r),t):(i(),t)},n.prototype.getPage=function(n){var t=$.Deferred(),i="getPage_"+n,r=this;return this.chuj(i,t,function(){r.cmsApi.getPage({id:n},function(n){r.cache.put(i,n);t.resolve(n)},function(){var n=window.location,t=window.location.hash;window.location.hash="login"})}),t},n.prototype.getPages=function(){var n=$.Deferred();return this.cmsApi.getPages(function(t){n.resolve(t)}),n},n.prototype.getAlbum=function(n){var t=$.Deferred();return n===null?(t.resolve(null),t):(this.cmsApi.getAlbum({id:n},function(n){t.resolve(n)}),t)},n.prototype.getAlbumPhotos=function(n){var t=$.Deferred(),i=n+"getAlbumPhotos",r=this;return n?(this.chuj(i,t,function(){r.cmsApi.getAlbumPhotos({id:n},function(n){r.cache.put(i,n);t.resolve(n)})}),t):(t.resolve([]),t)},n.prototype.getPhotos=function(){var n=$.Deferred(),t="getAlbumPhotosStream",i=this;return this.chuj(t,n,function(){i.cmsApi.getPhotos(function(r){i.cache.put(t,r);n.resolve(r)})}),n},n.prototype.getAlbums=function(){var n=$.Deferred();return this.cmsApi.getAlbums(function(t){n.resolve(t)}),n},n.prototype.snapshot=function(n,t){var i=$.Deferred();return this.cmsApi.putSnapshot({data:n,path:t},function(n){i.resolve(n)}),i.promise()},n.prototype.checkForSnapshot=function(n,t){t.snapshot&&n.$emit("page-loaded")},n}();ngcGdataAlbumDirective=["cmsApi",function(n){var t=new ApiWrapper(n);return{scope:{ngcGdataAlbum:"="},compile:function(){return function(n){t.getAlbum(n.ngcGdataAlbum).then(function(){})}}}}];ngcResponsiveImage=function(){var n=function(n){return n.windowWidth},t=function(n){return n.windowHeight},f=function(n,t){var i=t.FullSize.PhotoUri;return n>=768&&n<1200&&(i=t.Large.PhotoUri),n>=480&&n<768&&(i=t.Medium.PhotoUri),n<480&&(i=t.Small.PhotoUri),i},e=function(n){var i=new Image,t;return i.src=n,t=$.Deferred(),$(i).load(function(){var n=this;setTimeout(function(){t.resolve(n)},10)}),t},i=function(i){var u=n(i)<i.imageWidth,f=t(i)<i.imageWidth,r;i.containerWidth=u?null:i.imageWidth;f&&(r=t(i),i.containerWidth=Math.round(i.imageWidth/i.imageHeight*(r-50)))},o=function(n){n.containerWidth=n.imageWidth},r=function(t,r,o){var c=n(t),s,h=f(c,r);t.loading=!0;s=setTimeout(function(){t.showLoader=t.loading;t.$emit("ngc-responsive-image-loading",t.loading);t.$digest()},200);t.imagePromise=e(h).done(function(n){t.imageWidth=n.width;t.imageHeight=n.height;i(t);t.source=h;t.loading=!1;t.showLoader=!1;clearTimeout(s);t.$emit("ngc-responsive-image-loading",!1);t.$emit("ngc-responsive-image-skipping",!1);t.skipping=!1;u(o);t.$apply()})},u=function(n){n.css("position","relative");n.css("margin","0 auto");n.css("left","auto");n.css("top","auto")};return{scope:{galleryImage:"="},controller:["$scope",function(n){n.containerWidth="16";n.windowWidth=$(window).width();n.windowHeight=$(window).height();n.isFullSize=function(){return n.imageWidth<=n.containerWidth};n.isFullSizeCssClass=function(){return n.isFullSize()?"icon-resize-small":"icon-resize-full"};n.showFullSize=function(){n.isFullSize()?i(n):o(n)};n.isMovable=function(){return n.isOverFlowable()&&n.isFullSize()?"movable":""};n.fullSizeTooltip=function(){return n.isFullSize()?"Přizpůsobit na stránku":"Zobrazit původní velikost"};n.isOverFlowable=function(){return n.windowHeight<n.imageHeight||n.windowWidth<n.imageWidth};n.getCssWidth=function(n){return n===null?"auto":n+"px"};n.getCssHeight=function(n){return n===null?"auto":n+"px"}}],restrict:"E",replace:!0,templateUrl:"template.ngcResponsiveImage.html",compile:function(){return function(n,t){var i=t.find(".draggable");n.source=null;n.$watch("galleryImage",function(t){t!==undefined&&(n.imagePromise&&n.imagePromise.state()==="pending"&&(n.imagePromise.reject(),n.skipping=!0,n.$emit("ngc-responsive-image-skipping",!0)),r(n,t,i))});n.$watch("containerWidth",function(n,t){var r=t>n;i.css("width",n);r&&u(i)});n.$on("windowChanged",function(t,i){n.windowWidth=i.width;n.windowHeight=i.height;r(n,n.galleryImage)})}}}};var homeController=["$scope","test",function(n,t){t.getPages().then(function(t){n.pages=t.data});n.homeImagesBegin=[1,2,3,4,6,1];n.homeImagesEnd=[1,2,3,3];t.getPhotos().then(function(t){return n.homeImagesBegin=t.data.slice(0,6),n.homeImagesEnd=t.data.slice(7,11),t}).then(function(i){t.checkForSnapshot(n,i)})}],pageController=["$scope","test","$routeParams",function(n,t,i){n.link=i.link;t.getPage(n.link).then(function(t){return n.page=t.data,t}).then(function(i){setTimeout(function(){t.checkForSnapshot(n,i)},3e3)})}],loginController=["$scope","cmsApi",function(n,t){var u=new ApiWrapper(t),i=function(t){t&&(n.message=null);n.loading=t===null||typeof t=="undefined"?!0:t},r;i();t.getRequestToken(function(t){n.RequestToken=t.RequestToken;i(!1)},function(){n.message="Přihlašovací službe je nedostupná."});r=function(n){var t;switch(n){case 401:t="Špatné heslo nebo login";break;case 400:case 500:t=".";break;default:t="Vyskytla se neznámá chyba ".status}return t};n.submit=function(){i();var u={};u.UserName=n.UserName;u.Password=n.Password;u.RequestToken=n.RequestToken;t.login(u,function(){window.location.hash="home";i(!1)},function(t){n.message=r(t.status);i(!1)})}}],userDataForm=["$scope","cmsApi","$routeParams",function(n,t,i){n.link=i.link;var r=function(n){var t;switch(n){case 401:t="Pro odeslání formuláře je potřeba se přihásit. ";break;case 400:case 500:t=".";break;default:t="Vyskytla se neznámá chyba ".status}return t};n.post=function(){t.putUserData({data:n.data,key:n.key},function(){},function(t){n.$emit("set-message",r(t.status))})};n.serialized=function(){JSON.stringify(n.data)}}],gridelementGdataAlbumCtrl=["$scope","test","$routeParams","$location","$rootScope",function(n,t,i,r,u){function f(){var t=n.gridelement.Content;return t!==null?t.gdataAlbumId:null}n.gdataAlbumId=f();n.route={link:i.link};t.getAlbumPhotos(n.gdataAlbumId).then(function(t){var i=t.data.slice();n.firstPhoto=i.splice(0,1)[0];n.gdataAlbumPhotos=i;n.gdataAlbumPhotosAll=t});n.showImage=function(t,i){r.search("i",i);r.search("g",t);u.$broadcast("getAlbumPhotosSuccess",n.gdataAlbumPhotosAll,i)}}],simplehtml=["$scope",function(n){var i=new Showdown.converter,t=n.getGridElement();n.ContentToHtml=function(){return i.makeHtml(t.Resources&&t.Resources.text?t.Resources.text.Value:"")}}],galleryImageViewerController=["$scope","$routeParams","test","$location",function(n,t,i,r){function o(){return n.gallery!==null&&n.gallery!==undefined}function u(){return t.i}function e(){return t.g}function f(t){if(!n.gallery){n.newindex=t;i.getAlbumPhotos(e()).then(function(i){n.gallery=i.data;n.image=n.gallery[t]});return}n.image=n.gallery[t]}function s(){var t=e(),n=u();typeof n!="undefined"&&typeof t!="undefined"&&f(n)}n.$on("getAlbumPhotosSuccess",function(t,i,r){n.gallery=i;f(r)});n.$on("global-keydown",function(t,i){if(o()){var r=i.keyCode;switch(r){case 27:n.close();break;case 37:n.prev();break;case 32:case 39:n.next()}}});n.$on("$locationChangeSuccess",function(){var t=u();typeof t=="undefined"&&(n.gallery=null)});n.$on("ngc-responsive-image-loading",function(t,i){n.loading=i;n.$$phase!=="$digest"&&n.$digest()});n.$on("ngc-responsive-image-skipping",function(t,i){n.skipping=i;n.$$phase!=="$digest"&&n.$digest()});s();n.close=function(){location.hash="!"+r.path()};n.next=function(){var i=n.gallery.length,t=u();t++;t>=i&&(t=0);f(t);r.search("i",t)};n.prev=function(){var i=n.gallery.length,t=u();t--;t<=0&&(t=i-1);f(t);r.search("i",t)}}],pController=["$scope","test","$routeParams","$location",function(n,t,i,r){var u,f;n.link=i.link;u=function(){var t=r.search().g,u=i.elementIndex,n;return n=isNaN(u)?0:u,isNaN(t)||(n=t),n};t.getPage(n.link).then(function(t){return n.page=t.data,n.currentGridElement=n.page.GridElements[u()],t}).then(function(i){t.checkForSnapshot(n,i)});f=function(t){r.search("g",t);n.currentGridElement=n.page.GridElements[t]};n.next=function(){var t=u(),i=n.page.GridElements.length;(t++,t>i-1)||f(t)};n.prev=function(){var n=u();n<=0||(n--,f(n))}}];angular.module("appConfigModule",[]).value("appConfig",{});angular.module("apiModule",["ngResource","appConfigModule"]).factory("cmsApi",["$resource",function(n){return n("Service/cmsClientPHPService/:service",{service:"serverProxy.php"},{getPage:{method:"GET",isArray:!1,params:{action:"getPage"}},getRequestToken:{method:"GET",isArray:!1,params:{action:"getLogin"}},login:{method:"POST",isArray:!1,params:{action:"PostLogin",service:"login.php"}},post:{method:"POST",isArray:!1,params:{action:"getLogin"}},getPages:{method:"GET",isArray:!1,params:{action:"getPages"}},getAlbums:{method:"GET",isArray:!1,params:{action:"getAlbums"}},getAlbum:{method:"GET",isArray:!1,params:{action:"getAlbum"}},getAlbumPhotos:{method:"GET",isArray:!1,params:{action:"getAlbumPhotos"}},getPhotos:{method:"GET",isArray:!1,params:{action:"getPhotos"}},putUserData:{method:"PUT",isArray:!1,params:{service:"postData.php"}},putSnapshot:{method:"PUT",isArray:!1,params:{service:"snapshot.php"}}})}]);angular.module("HashBangURLs",[]).config(["$locationProvider",function(n){n.hashPrefix("!")}]);module=angular.module("defaultClient",["apiModule","ui.keypress","ui.event","ui.bootstrap","HashBangURLs"]);module.factory("cache",["$cacheFactory",function(n){return n("cmsCache")}]);module.factory("test",["cmsApi","cache",function(n,t){return new ApiWrapper(n,t)}]);module.config(["$routeProvider",function(n){n.when("/page/:link",{reloadOnSearch:!1,controller:pageController,templateUrl:"template.page.html",resolve:{api:"test"}}).when("/p/:link/:elementIndex",{reloadOnSearch:!1,controller:pController,templateUrl:"template.p.html"}).when("/home",{controller:homeController,templateUrl:"template.home.html"}).when("/login",{controller:loginController,templateUrl:"template.login.html"}).otherwise({redirectTo:"/home"})}]);module.directive("shortcut",function(){return{restrict:"E",replace:!0,scope:!0,link:function(n){jQuery(document).on("keydown",function(t){n.$apply(n.keyPressed(t))})}}});module.directive("gridelement",["$compile","$templateCache",function(n,t){return{scope:{grid:"=",gridelement:"="},link:function(i,r){i.$watch("gridelement",function(u){if(u){var f=i.gridelement.Skin||"",e=t.get(i.gridelement.Type+f+".thtml"),o=n(e)(i);r.html(o)}});i.getGridElement=function(){return i.gridelement}}}}]);module.directive("ngcGdataAlbum",ngcGdataAlbumDirective);module.directive("ngcLazyImage",ngcLazyImage);module.directive("ngcSimpleDrag",simpleDragDirective);module.directive("ngcResponsiveImage",ngcResponsiveImage);module.controller("appController",["$scope","test","$location",function(n,t,i){n.globalKeydown=function(t){n.$broadcast("global-keydown",t)};n.$on("set-message",function(t,i){n.message=i});n.$on("page-loaded",function(){var n=$("html").html();t.snapshot(n,i.path())})}])