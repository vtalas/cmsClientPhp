var EventDispatcher=function(){"use strict";function t(){this._listeners={}}t.prototype.addEventListener=function(t,e){if(!this._listeners[t]){this._listeners[t]=[]}this._listeners[t].push(e)};t.prototype.removeEventListener=function(t,e){if(this._listeners[t]){var s=this._listeners[t].indexOf(e);if(s!==-1){this._listeners[t].splice(s,1)}}};t.prototype.dispatchEvent=function(){var t;if(typeof arguments[0]!=="string"){console.warn("EventDispatcher","First params must be an event type (String)")}else{t=this._listeners[arguments[0]];for(var e in t){t[e](arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6])}}};return t}();
angular.module("appConfigModule",[]).value("appConfig",{});
"use strict";var moduleMaps=angular.module("maps",[]);moduleMaps.directive("ngcGoogleMap",["$sce","$parse","$timeout",function(o,a,e){var n={zoom:18,lat:49.214807,lng:16.570445};return{scope:{ngcGoogleMap:"="},link:function(o,a,g){var l=function(){var e=angular.extend(n,o.ngcGoogleMap),g={center:new google.maps.LatLng(e.lat,e.lng),zoom:e.zoom};var l=new google.maps.Map(a[0],g);o.map=l};e(function(){l()},1500)}}}]);
angular.module("notifications",[]).provider("$notify",function(){var n=new EventDispatcher;return{$get:function(){n.trigger=n.dispatchEvent;return n}}});
var stringUtils=angular.module("stringutils",[]);stringUtils.factory("$markdown",function(){var n=new Showdown.converter;return{toHtml:function(t){if(t){return n.makeHtml(t)}return""}}});stringUtils.directive("ngBindHtmlUnsafe",["$sce","$parse",function(n,t){return function(n,i,r){i.addClass("ng-binding").data("$binding",r.ngBindHtmlUnsafe);var a=t(r.ngBindHtmlUnsafe);function e(){return(a(n)||"").toString()}n.$watch(e,function(n){i.html(n)})}}]);
var ItemBrowser=function(){"use strict";var t=function(){return{}};function e(e,n){this.settings=angular.extend(t(),n);this.items=e||[];this.currentIndex=0}e.prototype.next=function(){if(this.currentIndex<this.items.length-1){this.currentIndex++}return this.getCurrent()};e.prototype.previous=function(){if(this.currentIndex>0){this.currentIndex--}return this.getCurrent()};e.prototype.selectByIndex=function(t){if(t>0&&t<this.items.length){this.currentIndex=t}return this.getCurrent()};e.prototype.getNext=function(){if(this.currentIndex===-1){return null}return this.items[this.currentIndex+1]||null};e.prototype.getPrevious=function(){return this.items[this.currentIndex-1]||null};e.prototype.getCurrent=function(){return this.items[this.currentIndex]||null};return e}();
var FitImage=function(){"use strict";var t=function(t,i,e,h){this.iWidth=t||0;this.iHeight=i||0;this.cWidth=e||0;this.cHeight=h||0};t.prototype.imageWidthCss=function(){return this.boxScale()>=this.imageScale()?"100%":"auto"};t.prototype.imageHeightCss=function(){return this.boxScale()<this.imageScale()?"100%":"auto"};t.prototype.imageScale=function(){return this.iWidth/this.iHeight};t.prototype.boxScale=function(){return this.cWidth/this.cHeight};return t}();
var Gallery=function(){"use strict";var t=function(){return{onLoad:function(){},onChange:function(){}}};function n(n){this.settings=angular.extend(t(),n);this.data=[];this.currentIndex=-1}n.prototype.loadData=function(t){if(t===undefined){t=[]}if(this.isArray(t)){this.data=t}else{this.data.push(t)}this.settings.onLoad()};n.prototype.showByIndex=function(t){this.currentIndex=this.data[t]?Number(t):-1;if(this.currentIndex!==-1){this.settings.onChange()}};n.prototype.showBy=function(t){for(var n=0;n<this.data.length;n++){var e=this.data[n];if(t(e)){this.currentIndex=n;this.settings.onChange();return}}};n.prototype.close=function(){};n.prototype.next=function(){if(this.currentIndex<this.data.length-1){this.currentIndex++;this.settings.onChange()}return this.getCurrent()};n.prototype.prev=function(){if(this.currentIndex>0){this.currentIndex--;this.settings.onChange()}return this.getCurrent()};n.prototype.getPrevious=function(){return this.data[this.currentIndex-1]||null};n.prototype.getNext=function(){if(this.currentIndex===-1){return null}return this.data[this.currentIndex+1]||null};n.prototype.getCurrent=function(){return this.data[this.currentIndex]||null};n.prototype.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"};return n}();
var galleryModule=angular.module("galleryBrowser",["notifications"]);galleryModule.factory("$gallery",["$notify",function(e){var r={onChange:function(){e.trigger("gallery-changed")},onLoad:function(){e.trigger("gallery-loaded")}};return new Gallery(r)}]);galleryModule.directive("ngcFitToBoxImage",[function(){return{template:'<div ><img class="fit-image" src="{{imageSrc}}" /></div>',replace:true,scope:{ngcFitToBoxImage:"="},link:function(e,r,t){e.$watch("ngcFitToBoxImage",function(t,n){var a,l,o;if(t){l=r.find("img");a=r.width();o=r.height();if(t.Width){console.log("not implemented")}else{var i=new Image;i.onload=function(){var e=new FitImage(this.width,this.height,a,o);l.css("height",e.imageHeightCss());l.css("width",e.imageWidthCss())};i.src=t;e.imageSrc=t}}})}}}]);galleryModule.controller("galleryBrowser",["$scope","$api","$location","$rootScope","$timeout","$routeParams","$gallery","$notify",function(e,r,t,n,a,l,o,i){i.addEventListener("gallery-loaded",function(){var r=t.search().galleryIndex;if(r){o.showByIndex(r);e.overlayGalleryShow=o.currentIndex>-1}e.currentItem=o.getCurrent();e.prevItem=o.getPrevious();e.nextItem=o.getNext()});i.addEventListener("gallery-changed",function(){angular.element("body").css("overflow","hidden");e.overlayGalleryShow=true;e.currentItem=o.getCurrent();e.nextItem=o.getNext();e.prevItem=o.getPrevious();t.search("galleryIndex",o.currentIndex)});var c=function(){return e.overlayGalleryShow};e.close=function(){angular.element("body").css("overflow","auto");e.overlayGalleryShow=false;t.search("galleryIndex",null)};e.prev=function(){e.currentItem=o.prev();e.nextItem=o.getNext();e.prevItem=o.getPrevious();t.search("galleryIndex",o.currentIndex)};e.next=function(){e.currentItem=o.next();e.nextItem=o.getNext();e.prevItem=o.getPrevious();t.search("galleryIndex",o.currentIndex)};e.$on("global-keydown",function(r,t){if(!c()){return}var n=t.keyCode;switch(n){case 27:e.close();break;case 33:e.prev();break;case 34:e.next();break}})}]);
var ApiWrapper=function(){function t(t,e,o){this.cmsApi=t;this.cache=e;this.q=o}t.prototype.loadFromCache=function(t,e,o){var r=this.cache.get(t);if(r){e.resolve(r);return e}o();return e};t.prototype.getPage=function(t){var e=this.q.defer(),o="getPage_"+t,r=this;this.loadFromCache(o,e,function(){r.cmsApi.getJsonData({},function(i){var n=new GridList(i.data).getGridByLink(t);r.cache.put(o,n);e.resolve(n)},function(t){var o=window.location;var r=window.location.hash;if(t.status===403){window.location.hash="!login"}e.reject(t)})});return e.promise};t.prototype.getPages=function(){var t=this.q.defer();this.cmsApi.getPages(function(e){t.resolve(e)});return t.promise};t.prototype.getJsonData=function(){var t=this.q.defer();this.cmsApi.getJsonData(function(e){t.resolve(new GridList(e.data))});return t.promise};t.prototype.getAlbum=function(t,e){var o=this.q.defer(),r=e||{};if(t===null){o.resolve(null);return o.promise}r.id=t;this.cmsApi.getAlbum(r,function(t){o.resolve(t)});return o.promise};t.prototype.getAlbumPhotos=function(t){var e=this.q.defer(),o=t+"getAlbumPhotos",r=this;if(!t){e.resolve([]);return e.promise}this.loadFromCache(o,e,function(){r.cmsApi.getAlbumPhotos({id:t},function(t,i){r.cache.put(o,t);e.resolve(t)})});return e.promise};t.prototype.getPhotos=function(){var t=this.q.defer(),e="getAlbumPhotosStream",o=this;this.loadFromCache(e,t,function(){o.cmsApi.getPhotos(function(r){o.cache.put(e,r);t.resolve(r)})});return t.promise};t.prototype.getAlbums=function(){var t=this.q.defer();this.cmsApi.getAlbums(function(e){t.resolve(e)});return t.promise};t.prototype.snapshot=function(t,e){var o=this.q.defer();this.cmsApi.putSnapshot({data:t,path:e},function(t){o.resolve(t)});return o.promise};t.prototype.checkForSnapshot=function(t,e){if(e){t.$emit("page-loaded")}};return t}();
angular.module("apiModule",["ngResource","appConfigModule"]).factory("cmsApi",["$resource",function(a){var e=a("Service/cmsClientPHPService/:service",{service:"serverProxy.php"},{getJsonData:{method:"GET",isArray:false,params:{action:"getJson"}},getPage:{method:"GET",isArray:false,params:{action:"getPage"}},getRequestToken:{method:"GET",isArray:false,params:{action:"getLogin"}},login:{method:"POST",isArray:false,params:{action:"PostLogin",service:"login.php"}},post:{method:"POST",isArray:false,params:{action:"getLogin"}},getPages:{method:"GET",isArray:false,params:{action:"getPages"}},getAlbums:{method:"GET",isArray:false,params:{action:"getAlbums"}},getAlbum:{method:"GET",isArray:false,params:{action:"getAlbum"}},getAlbumPhotos:{method:"GET",isArray:false,params:{action:"getAlbumPhotos"}},getPhotos:{method:"GET",isArray:false,params:{action:"getPhotos"}},putUserData:{method:"PUT",isArray:false,params:{service:"postData.php"}},putSnapshot:{method:"PUT",isArray:false,params:{service:"snapshot.php"}}});return e}]);
var repository=angular.module("repo",["apiModule"]);repository.factory("$api",["cmsApi","$cacheFactory","$q",function(r,a,o){return new ApiWrapper(r,a("cmsCache"),o)}]);repository.factory("loadFromCache",["cmsApi","$cacheFactory","$q",function(r,a,o){return":ashdvjad"}]);repository.factory("loadGridList",["$api","$cacheFactory","$q",function(r,a,o){return r.getJsonData()}]);
var gridModule=angular.module("grids",[]);gridModule.directive("ngcAspectRatio",[function(){return{templateUrl:"aspectRatio.html",transclude:true,link:function(t,i,a){t.ratioWidth=Number(a.w)||4;t.ratioHeight=Number(a.h)||3;function r(t,i){return i/t*100}t.$watch("ratioWidth",function(i){t.ratioCalculated={"padding-top":r(t.ratioWidth,t.ratioHeight)+"%"}});t.$watch("ratioHeight",function(){t.ratioCalculated={"padding-top":r(t.ratioWidth,t.ratioHeight)+"%"}})}}}]);
var Grid=function(){function i(i){i=i||{};this.GridElements=i.GridElements||[];this.Link=i.Link||null;this.Name=i.Name||"";this.id=i.id||null;this.resources=i.resources||[];this.groups=i.groups||null}return i}();
var GridElementsList=function(){function t(t){this.data=t||[]}t.prototype.getGroups=function(){for(var t=0;t<this.data.length;t++){}return""};t.prototype.findById=function(t){for(var r=0;r<this.data.length;r++){if(t===this.data[r].Id){return this.data[r]}}return null};t.prototype.filter=function(t,r){var n,a,i=[];for(n=0;n<this.data.length;n++){a=this.data[n].resources;if(a&&a[t]===r){i.push(this.data[n])}}return i};return t}();
var GridList=function(){function t(t,i){this.data=t||[];this.repo=i}t.prototype.addGrid=function(t){t.id="grid_"+(this.data.length+1);this.data.push(t);this.repo.set(this.data)};t.prototype.save=function(){this.repo.set(this.data)};t.prototype.update=function(t){var i=this.data.indexOf(t);this.data[i]=t;this.repo.set(this.data)};t.prototype.remove=function(t){this.data.splice(this.data.indexOf(t),1);this.repo.set(this.data)};t.prototype.getGrid=function(t){for(var i=0;i<this.data.length;i++){var r=this.data[i];if(r.id===t){return new Grid(r)}}return new Grid};t.prototype.getGridByLink=function(t){for(var i=0;i<this.data.length;i++){var r=this.data[i];if(r.Link===t){return new Grid(r)}}return new Grid};t.prototype.getGridsByCategory=function(t){var i=[];for(var r=0;r<this.data.length;r++){var a=this.data[r];if(a.Category===t&&a.visible){i.push(new Grid(a))}}return i};return t}();
var galleryImageViewerController=["$scope","$routeParams","$api","$location",function(e,n,a,i){e.$on("galleryImageViewer-display-image",function(n,a,i){e.imageIndex=i;e.galleryId=a;r(a,i)});e.$on("global-keydown",function(n,a){if(!l()){return}var i=a.keyCode;switch(i){case 27:e.close();break;case 37:e.prev();break;case 32:case 39:e.next();break}});e.$on("ngc-responsive-image-loading",function(n,a){e.loading=a;if(e.$$phase!=="$digest"){e.$digest()}});e.$on("ngc-responsive-image-skipping",function(n,a){e.skipping=a;if(e.$$phase!=="$digest"){e.$digest()}});function l(){return e.gallery!==null&&e.gallery!==undefined}function r(n,i){if(!e.gallery){e.newindex=i;a.getAlbumPhotos(n).then(function(n){e.gallery=n.data;e.image=e.gallery[i]});return}e.image=e.gallery[i]}e.close=function(){i.search("gid",null);i.search("i",null);e.gallery=null};e.next=function(){var n=e.gallery.length,a=e.imageIndex;a++;if(a>=n){a=0}i.search("i",a)};e.prev=function(){var n=e.gallery.length,a=e.imageIndex;a--;if(a<=0){a=n-1}i.search("i",a)}}];
var gridelementKontaktCtrl=["$scope","$api","$routeParams","$location","$rootScope",function(e,a,u,l){function r(e){return n[e]||""}var n=e.gridelement.resources||{};e.header=r("header");e.subHeader=r("subheader");e.valueA=r("valuea");e.valueB=r("valueb");e.valueC=r("valuec");e.valueD=r("valued");e.valueE=r("valuee");e.valueF=r("valuef");function v(e){return n[e]||null}e.map=v("map");e.hasMap=e.map!==null;e.blockSize=e.map?"grid_12":"grid_3"}];
var gridelementAlbumCtrl=["$scope","$api","$routeParams","$location","$notify","$gallery","$element",function(e,t,n,a,r,i,u){var l=e.gridelement.resources||{},o=e.gridelement.Content||{};function m(e,t){return l[e]||t||""}function d(e,t){return o[e]||t||""}e.gdataAlbumId=d("gdataAlbumId",null);e.route={link:n.link};e.name=m("name"," ");e.type=m("type");e.services=m("services");e.year=m("year");e.text=m("text");e.cssRatio=d("ratio","ratio16_9");setTimeout(function(){var n=u.height()-44,a,r=0,i=u.width();a=Math.max(i,n);if(n>i){r=1}if(e.gdataAlbumId){t.getAlbum(e.gdataAlbumId,{size:a,isSquare:false,type:r}).then(function(t){if(t){e.album=t.data}})}},1);e.imageClick=function(){e.gridelement.Id;i.showBy(function(t){return e.gridelement.Id===t.Id})}}];var gridelementAlbumOverlayCtrlPreview=["$scope","$api","$routeParams","$location","$notify","$gallery","$markdown",function(e,t,n,a,r,i,u){e.gdataAlbumId=l();e.route={link:n.link};function l(){var t=e.gridelement.Content;return t!==null?t.gdataAlbumId:null}var o=e.gridelement.resources||{};function m(e){return o[e]||""}e.name=m("name");e.type=m("type");e.services=m("services");e.year=m("year");e.text=u.toHtml(m("text"));e.toHtml=function(e){return u.toHtml(e)};t.getAlbumPhotos(e.gdataAlbumId).then(function(t){if(t&&t.data){e.albumPhotos=t.data;e.currentImage=e.albumPhotos[0];e.currentImageIndex=0}});e.showImagePreview=function(t){e.currentImage=e.albumPhotos[t];e.currentImageIndex=t}}];
var gridelementAlbumOverlayCtrl=["$scope","$api","$routeParams","$location","$notify","$gallery","$markdown",function(e,t,n,r,a,u,m){e.gdataAlbumId=o();e.route={link:n.link};function o(){var t=e.gridelement.Content;return t!==null?t.gdataAlbumId:""}var g=e.gridelement.resources||{};function I(e){return g[e]||null}e.name=I("name");e.type=I("type");e.services=I("services");e.year=I("year");e.text=m.toHtml(I("text"));e.map=I("map");e.hasMap=e.map!==null;e.toHtml=function(e){return m.toHtml(e)};var i;t.getAlbumPhotos(e.gdataAlbumId).then(function(t){if(t){e.albumPhotos=t.data;i=new ItemBrowser(t.data);e.currentImage=i.getCurrent();e.currentImageIndex=i.currentIndex;e.previousImage=i.getPrevious();e.nextImg=i.getNext()}});e.showImagePreview=function(t){e.currentImage=i.selectByIndex(t);e.currentImageIndex=i.currentIndex;e.previousImage=i.getPrevious();e.nextImg=i.getNext()};e.prevImage=function(){e.currentImage=i.previous();e.currentImageIndex=i.currentIndex;e.previousImage=i.getPrevious();e.nextImg=i.getNext()};e.nextImage=function(){e.currentImage=i.next();e.currentImageIndex=i.currentIndex;e.previousImage=i.getPrevious();e.nextImg=i.getNext()};e.$on("global-keydown",function(t,n){var r=n.keyCode;switch(r){case 37:e.prevImage();break;case 39:e.nextImage();break}})}];
var gridelementGdataAlbumCtrl=["$scope","$api","$routeParams","$location","$rootScope",function(e,t,a,n){e.gdataAlbumId=r();e.route={link:a.link};function r(){var t=e.gridelement.Content;return t!==null?t.gdataAlbumId:null}e.header=e.gridelement.Resources.header.Value;e.text=e.gridelement.Resources.text.Value;t.getAlbum(e.gdataAlbumId,{size:100,isSquare:true,type:2}).then(function(t){e.album=t.data});e.showImage=function(e,t){n.search("i",t);n.search("gid",e)}}];
var homeController=["$scope","$api",function(t,e){t.homeData=[];t.nextWorkData=[];t.pageLink="projekty";t.loadedData=false;t.loadedImages=false;t.showLoader=true;t.tempLength=0;function a(a,o){return e.getAlbumPhotos(o).then(function(e){t.homeData[a].images=e.data[0];t.tempLength++;if(t.tempLength>t.homeData.length){t.loadedImages=true}})}var o=$(".page-home");o.hide();function n(e,a,o){var n=e.width(),i=e.height(),d,h;if(t.disableAutoFormat){return}if(a>n){d=n/i;h=Math.floor(d*o-50);e.css("max-width",h)}}t.$on("windowChanged",function(t,e){n(o,e.width,e.height)});e.getPage(t.pageLink).then(function(e){t.homeData=e.data.GridElements;setTimeout(function(){t.loadedData=true;t.$digest()},1e3);n(o,$(window).width(),$(window).height());t.$emit("data-loaded");return e.data}).then(function(t){var e=[];for(var o=0;o<t.GridElements.length;o++){var n=t.GridElements[o].Content;e.push(a(o,n.gdataAlbumId))}});t.showNextWork=function(){t.nextWork=true;t.disableAutoFormat=true;$("html, body").animate({scrollTop:$(document).height()},1e3)}}];
var loginController=["$scope","cmsApi",function(e,n){var s=new ApiWrapper(n);var a=function(n){if(n){e.message=null}e.loading=n===null||typeof n==="undefined"?true:n};a();n.getRequestToken(function(n){e.RequestToken=n.RequestToken;a(false)},function(){e.message="Přihlašovací službe je nedostupná."});var o=function(e){var n;switch(e){case 401:n="Špatné heslo nebo login";break;case 400:case 500:n=".";break;default:n="Vyskytla se neznámá chyba ".status}return n};e.submit=function(){a();var s={};s.UserName=e.UserName;s.Password=e.Password;s.RequestToken=e.RequestToken;n.login(s,function(e){window.location.hash="home";a(false)},function(n){e.message=o(n.status);a(false)})}}];
var pController=["$scope","$api","$routeParams","$location","$notify",function(e,n,r,i,t){e.link=r.link;var l=function(){var e=i.search().elindex,n=r.elementIndex,t;t=!isNaN(n)?n:0;if(!isNaN(e)){t=e}return Number(t,10)||0};var a=function(n){var r=e.page.GridElements.length;e.isFirst=n===0;e.isLast=n===r-1};e.loading=true;var o=n.getPage(e.link).then(function(n){var r=l();e.page=n;a(r);e.currentGridElement=e.page.GridElements[r];t.trigger("content-loaded");return n});var s=function(n){i.search("elindex",n);o.then(function(){e.currentGridElement=e.page.GridElements[n];a(n)})};e.next=function(){var n=l(),r=e.page.GridElements.length;n++;if(n>r-1){return}s(n)};e.prev=function(){var e=l();if(e<=0){return}e--;s(e)};var c=angular.element(".navigation");angular.element(window).scroll(function(){var n=$(this).scrollTop(),r=50;if(n>r&&!e.isScrolled){e.isScrolled=true;c.addClass("scrolled")}if(n<r&&e.isScrolled){e.isScrolled=false;c.removeClass("scrolled")}})}];
var pageController=["$scope","$api","$routeParams","$gallery","$notify","$timeout","loadGridList",function(e,t,n,i,l,r,o){var a=null,u;e.link=n.link;o.then(function(t){u=t;e.page=u.getGridByLink(e.link);e.gridElements=e.page.GridElements;e.groups=e.page.groups;e.layoutClass=e.groups?"grid_10":"grid_12";l.trigger("content-loaded");a=new GridElementsList(e.page.GridElements);i.loadData(e.gridElements||[]);return e.page},function(e){console.log("ERROR!!",e.status)}).then(function(n){setTimeout(function(){t.checkForSnapshot(e,n)},3e3)});l.trigger("content-loading");e.filter=function(t){if(t===undefined){e.filterValue=null;e.gridElements=a.data;return}e.filterValue=t;e.gridElements=a.filter("group",t)};e.isSelectedFilter=function(t){return e.filterValue===t?"selected":null}}];
var simplehtml=["$scope","$markdown",function(t,n){var e=t.getGridElement(),r=e.resources||{};function o(t){return r[t]||""}t.ContentToHtml=function(){return n.toHtml(o("text"))}}];
var userDataForm=["$scope","cmsApi","$routeParams",function(a,t,e){a.link=e.link;var s=function(a){var t;switch(a){case 401:t="Pro odeslání formuláře je potřeba se přihásit. ";break;case 400:case 500:t=".";break;default:t="Vyskytla se neznámá chyba ".status}return t};a.post=function(){t.putUserData({data:a.data,key:a.key},function(a){},function(t){a.$emit("set-message",s(t.status))})};a.serialized=function(){JSON.stringify(a.data)}}];
var ngcGdataAlbumDirective=["cmsApi",function(n){var t=new ApiWrapper(n);return{scope:{ngcGdataAlbum:"="},compile:function(n,c,e){return function(n,c,e){t.getAlbum(n.ngcGdataAlbum).then(function(n){})}}}}];
function ngcLazyImage(){var e="resources/loaders/loader16.gif";return{scope:{ngcLazyImage:"="},link:function(n,a,r){if(r.loader!==undefined){e=r.loader}n.$watch("ngcLazyImage",function(e,n){if(e!==undefined){a.attr("src",e)}})}}}
function ngcOverlay(){return{restrict:"E",transclude:true,templateUrl:"Templates/template.ngcOverlay.html",compile:function(t){return function(t,e,n){}}}}
var ngcResponsiveImage=function(){var i=function(i){return i.windowWidth};var e=function(i){return i.windowHeight};var n=function(i,e){var n=e.FullSize.PhotoUri;if(i>=768&&i<1200){n=e.Large.PhotoUri}if(i>=480&&i<768){n=e.Medium.PhotoUri}if(i<480){n=e.Small.PhotoUri}return n};var t=function(i){var e=new Image,n;e.src=i;n=$.Deferred();$(e).load(function(){var i=this;setTimeout(function(){n.resolve(i)},10)});return n};var o=function(n){var t=i(n)<n.imageWidth;var o=e(n)<n.imageWidth;if(t){n.containerWidth=null}else{n.containerWidth=n.imageWidth}if(o){var r=e(n);n.containerWidth=Math.round(n.imageWidth/n.imageHeight*r)}};var r=function(i){i.containerWidth=i.imageWidth};var a=function(e,r,a){var s=i(e),u,g=n(s,r);e.loading=true;u=setTimeout(function(){e.showLoader=e.loading;e.$emit("ngc-responsive-image-loading",e.loading);e.$digest()},200);e.imagePromise=t(g).done(function(i){e.imageWidth=i.width;e.imageHeight=i.height;o(e);e.source=g;e.loading=false;e.showLoader=false;clearTimeout(u);e.$emit("ngc-responsive-image-loading",false);e.$emit("ngc-responsive-image-skipping",false);e.skipping=false;l(a);e.$apply()})};var l=function(i){i.css("position","relative");i.css("margin","0 auto");i.css("left","auto");i.css("top","auto")};return{scope:{galleryImage:"="},controller:["$scope",function(i){i.containerWidth="16";i.windowWidth=$(window).width();i.windowHeight=$(window).height();i.isFullSize=function(){return i.imageWidth<=i.containerWidth};i.isFullSizeCssClass=function(){if(!i.isFullSize()){return"icon-resize-full"}return"icon-resize-small"};i.showFullSize=function(){if(!i.isFullSize()){r(i)}else{o(i)}};i.isMovable=function(){return i.isOverFlowable()&&i.isFullSize()?"movable":""};i.fullSizeTooltip=function(){return i.isFullSize()?"Přizpůsobit na stránku":"Zobrazit původní velikost"};i.isOverFlowable=function(){return i.windowHeight<i.imageHeight||i.windowWidth<i.imageWidth};i.getCssWidth=function(i,e){return i===null?"auto":i+"px"};i.getCssHeight=function(i){return i===null?"auto":i+"px"}}],restrict:"E",replace:true,templateUrl:"Templates/template.ngcResponsiveImage.html",compile:function(){return function(i,e){var n=e.find(".draggable");i.source=null;i.$watch("galleryImage",function(e,t){if(e===undefined){return}if(i.imagePromise){if(i.imagePromise.state()==="pending"){i.imagePromise.reject();i.skipping=true;i.$emit("ngc-responsive-image-skipping",true)}}a(i,e,n)});i.$watch("containerWidth",function(i,e){var t=e>i;n.css("width",i);if(t){l(n)}});i.$on("windowChanged",function(e,t){i.windowWidth=t.width;i.windowHeight=t.height;if(i.galleryImage){a(i,i.galleryImage,n)}})}}}};
function simpleDragDirective(){var e=function(e,n,t,a){var r,o;if(e.pageX&&e.pageY){r=e.pageX-t;o=e.pageY-a;n.css("left",r);n.css("top",o)}};return{link:function(n,t,a){var r=0;var o=0;t.bind({dragstart:function(n){var a=n.originalEvent;r=a.offsetX;o=a.offsetY;e(a,t,r,o);t.css("position","absolute")},dragover:function(n){var a=n.originalEvent;n.stopPropagation();n.preventDefault();var f=n.originalEvent.dataTransfer;f.effectAllowed=f.dropEffect="none";e(a,t,r,o)},dragenter:function(e){e.stopPropagation();e.preventDefault();var n=e.originalEvent.dataTransfer;n.effectAllowed=n.dropEffect="none"}})}}}
angular.module("HashBangURLs",[]).config(["$locationProvider",function(e){e.hashPrefix("!")}]);var module=angular.module("defaultClient",["ngRoute","galleryBrowser","repo","ui.keypress","ui.event","ui.bootstrap","HashBangURLs","stringutils","maps","ngAnimate"]);module.config(["$routeProvider",function(e){e.when("/page/:link",{reloadOnSearch:false,controller:pageController,templateUrl:"Templates/template.page.html",resolve:{api:"$api"}}).when("/p/:link",{reloadOnSearch:false,controller:pController,templateUrl:"Templates/template.p.html"}).otherwise({redirectTo:"/page/home"})}]);module.directive("shortcut",function(){return{restrict:"E",replace:true,scope:true,link:function(e){jQuery(document).on("keydown",function(n){e.$apply(e.keyPressed(n))})}}});module.directive("gridelement",["$compile","$templateCache","$timeout",function(e,n,t){var i;return{scope:{grid:"=",gridelement:"="},link:function(o,a,r,l){o.$watch("gridelement",function(l){if(!l){return}var c=o.gridelement.Skin||r.skin||null,d=c?"_"+c:"";var u=n.get(o.gridelement.Type+d+".thtml");var s=e(u)(o);if(i){t.cancel(i)}i=t(function(){o.$emit("page-loaded")},500);a.html(s)});o.getGridElement=function(){return o.gridelement}}}}]);module.directive("ngcOverlay",ngcOverlay);module.directive("ngcGdataAlbum",ngcGdataAlbumDirective);module.directive("ngcLazyImage",ngcLazyImage);module.directive("ngcSimpleDrag",simpleDragDirective);module.directive("ngcResponsiveImage",ngcResponsiveImage);module.controller("appController",["$scope","$api","$location","$rootScope","$timeout","$routeParams","$notify","$animate","loadGridList",function(e,n,t,i,o,a,r,l,c){e.showContent=false;var d={};$(".centered-container").css("height",$(window).height()).css("width",$(window).width());var u;c.then(function(n){d=n;e.mainMenu=n.getGridsByCategory("Page")});$(window).resize(function(){if(u){o.cancel(u)}u=o(function(){e.$broadcast("windowChanged",{width:$(window).width(),height:$(window).height()})},200)});var s;r.addEventListener("content-loading",function(){s=setTimeout(function(){e.$apply(function(){e.showLoader=true})},500)});r.addEventListener("content-loaded",function(){clearTimeout(s);e.showLoader=false;e.showContent=true});e.globalKeydown=function(n){e.$broadcast("global-keydown",n)};e.$on("set-message",function(n,t){e.message=t});e.$on("page-loaded",function(){var e=$("html").html();n.snapshot(e,t.path())});var g=function(){var e=t.search();if(e.gid&&e.i!==undefined){i.$broadcast("galleryImageViewer-display-image",e.gid,e.i)}};e.$watch("resourcesLoaded",function(e){if(e){g()}});e.isSelectedLink=function(e){return a.link===e?"selected":null}}]);